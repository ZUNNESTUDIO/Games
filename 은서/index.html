<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ì í”„í•˜ëŠ” ê²Œì„ - ë¯¸ì•¼ì˜¬</title>
  <style>
    body {
      margin: 0;
      background: #d7f0ff;
      font-family: 'Noto Sans KR', sans-serif;
      text-align: center;
    }

    #startScreen {
      margin-top: 80px;
    }

    .difficulty-btn {
      display: block;
      margin: 20px auto;
      padding: 15px 40px;
      font-size: 22px;
      font-weight: bold;
      border-radius: 10px;
      cursor: pointer;
      border: none;
    }

    .easy {
      background: #b6f7a5;
    }

    .normal {
      background: #ffe58f;
    }

    .hard {
      background: #ff9f9f;
    }

    #gameCanvas {
      background: #a6e3ff;
      display: none;
      margin: 20px auto;
      border: 3px solid #333;
    }

    #info {
      font-size: 20px;
      font-weight: bold;
      display: none;
    }

    #resultScreen {
      display: none;
      margin-top: 30px;
    }

    #resultScreen h2 {
      font-size: 26px;
      margin-bottom: 20px;
    }

    #restartButton {
      padding: 12px 28px;
      font-size: 20px;
      font-weight: bold;
      border: none;
      border-radius: 10px;
      background: #6cc4ff;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div id="startScreen">
    <h1>ğŸ® ì í”„í•˜ëŠ” ê²Œì„ â€” ë¯¸ì•¼ì˜¬</h1>
    <h2>ë‚œì´ë„ë¥¼ ì„ íƒí•˜ì„¸ìš”</h2>
    <p>â† â†’ ë¡œ ì´ë™í•˜ê³  â†‘ ë¡œ ì í”„í•´ìš”. ì í”„ 30ë²ˆì„ ì„±ê³µí•˜ë©´ í´ë¦¬ì–´!</p>

    <button class="difficulty-btn easy" onclick="startGame('easy')">ì´ˆë³´ (ë§¤ìš° ë‹¨ìˆœ)</button>
    <button class="difficulty-btn normal" onclick="startGame('normal')">ì¤‘ìˆ˜ (ì¡°ê¸ˆ ë³µì¡)</button>
    <button class="difficulty-btn hard" onclick="startGame('hard')">ê³ ìˆ˜ (ë§¤ìš° ë³µì¡)</button>
  </div>

  <canvas id="gameCanvas" width="700" height="400"></canvas>
  <div id="info">ì í”„ íšŸìˆ˜: 0 / 30</div>

  <div id="resultScreen">
    <h2 id="resultMessage"></h2>
    <button id="restartButton" onclick="restartGame()">ë‹¤ì‹œ ì‹œì‘</button>
  </div>

  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const startScreen = document.getElementById('startScreen');
    const info = document.getElementById('info');
    const resultScreen = document.getElementById('resultScreen');
    const resultMessage = document.getElementById('resultMessage');

    const DIFFICULTY_SETTINGS = {
      easy: { speedMin: 3, speedMax: 4, respawnMin: 650 },
      normal: { speedMin: 4, speedMax: 6, respawnMin: 550 },
      hard: { speedMin: 6, speedMax: 9, respawnMin: 450 }
    };

    const keys = {};
    let difficulty = null;
    let currentLevel = null;
    let miyawol;
    let obstacle;
    let jumpCount = 0;
    let gameOver = false;

    document.addEventListener('keydown', (e) => {
      keys[e.key] = true;
    });

    document.addEventListener('keyup', (e) => {
      keys[e.key] = false;
    });

    function drawCat(ctx, x, y, w, h) {
      const headRadius = w * 0.4;

      ctx.fillStyle = '#ffc7c7';
      ctx.fillRect(x + w * 0.2, y + h * 0.5, w * 0.6, h * 0.5);

      ctx.beginPath();
      ctx.fillStyle = '#ffb6c1';
      ctx.arc(x + w / 2, y + h * 0.35, headRadius, 0, Math.PI * 2);
      ctx.fill();

      ctx.beginPath();
      ctx.moveTo(x + w * 0.35, y + h * 0.18);
      ctx.lineTo(x + w * 0.25, y + h * 0.32);
      ctx.lineTo(x + w * 0.45, y + h * 0.32);
      ctx.fillStyle = '#ff9eb2';
      ctx.fill();

      ctx.beginPath();
      ctx.moveTo(x + w * 0.65, y + h * 0.18);
      ctx.lineTo(x + w * 0.55, y + h * 0.32);
      ctx.lineTo(x + w * 0.75, y + h * 0.32);
      ctx.fill();

      ctx.fillStyle = '#000';
      ctx.beginPath();
      ctx.arc(x + w * 0.42, y + h * 0.35, w * 0.05, 0, Math.PI * 2);
      ctx.fill();

      ctx.beginPath();
      ctx.arc(x + w * 0.58, y + h * 0.35, w * 0.05, 0, Math.PI * 2);
      ctx.fill();

      ctx.fillStyle = '#ff6f91';
      ctx.beginPath();
      ctx.arc(x + w * 0.5, y + h * 0.42, w * 0.03, 0, Math.PI * 2);
      ctx.fill();

      ctx.strokeStyle = '#ff6f91';
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.moveTo(x + w * 0.5, y + h * 0.45);
      ctx.lineTo(x + w * 0.48, y + h * 0.48);
      ctx.moveTo(x + w * 0.5, y + h * 0.45);
      ctx.lineTo(x + w * 0.52, y + h * 0.48);
      ctx.stroke();
    }

    function startGame(level) {
      difficulty = DIFFICULTY_SETTINGS[level];
      currentLevel = level;
      initializeGame();
      startScreen.style.display = 'none';
      canvas.style.display = 'block';
      info.style.display = 'block';
      resultScreen.style.display = 'none';
      info.textContent = `ì í”„ íšŸìˆ˜: ${jumpCount} / 30`;
      requestAnimationFrame(update);
    }

    function initializeGame() {
      miyawol = {
        x: 100,
        y: 300,
        width: 60,
        height: 80,
        vy: 0,
        gravity: 0.6,
        onGround: true
      };

      obstacle = {
        x: canvas.width,
        y: 330,
        width: 40,
        height: 40,
        speed: getRandomSpeed()
      };

      jumpCount = 0;
      gameOver = false;
      keys.ArrowLeft = false;
      keys.ArrowRight = false;
      keys.ArrowUp = false;
    }

    function getRandomSpeed() {
      return difficulty.speedMin + Math.random() * (difficulty.speedMax - difficulty.speedMin);
    }

    function jump() {
      if (!miyawol.onGround || gameOver) {
        return;
      }

      miyawol.vy = -12;
      miyawol.onGround = false;
      jumpCount += 1;
      info.textContent = `ì í”„ íšŸìˆ˜: ${jumpCount} / 30`;

      if (jumpCount >= 30) {
        endGame('ğŸ‰ ê²Œì„ í´ë¦¬ì–´! ë¯¸ì•¼ì˜¬ì´ ì í”„ 30ë²ˆ ì„±ê³µí–ˆìŠµë‹ˆë‹¤!');
      }
    }

    function update() {
      if (gameOver) {
        return;
      }

      if (keys.ArrowLeft) miyawol.x -= 5;
      if (keys.ArrowRight) miyawol.x += 5;
      if (keys.ArrowUp) jump();

      miyawol.x = Math.max(0, Math.min(canvas.width - miyawol.width, miyawol.x));

      miyawol.y += miyawol.vy;
      miyawol.vy += miyawol.gravity;

      if (miyawol.y > 300) {
        miyawol.y = 300;
        miyawol.vy = 0;
        miyawol.onGround = true;
      }

      obstacle.x -= obstacle.speed;
      if (obstacle.x < -50) {
        obstacle.x = difficulty.respawnMin + Math.random() * 200;
        obstacle.speed = getRandomSpeed();
      }

      const isColliding =
        miyawol.x < obstacle.x + obstacle.width &&
        miyawol.x + miyawol.width > obstacle.x &&
        miyawol.y < obstacle.y + obstacle.height &&
        miyawol.y + miyawol.height > obstacle.y;

      if (isColliding) {
        endGame('ğŸ’¥ ë¯¸ì•¼ì˜¬ì´ ì¥ì• ë¬¼ì— ë¶€ë”ªí˜”ìŠµë‹ˆë‹¤! ê²Œì„ ì˜¤ë²„!');
        return;
      }

      draw();
      requestAnimationFrame(update);
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      ctx.fillStyle = '#83c9f4';
      ctx.fillRect(0, 360, canvas.width, 40);

      drawCat(ctx, miyawol.x, miyawol.y, miyawol.width, miyawol.height);

      ctx.fillStyle = '#444';
      ctx.fillRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);
    }

    function endGame(message) {
      gameOver = true;
      info.style.display = 'none';
      resultMessage.textContent = message;
      resultScreen.style.display = 'block';
    }

    function restartGame() {
      if (!currentLevel) {
        startScreen.style.display = 'block';
        canvas.style.display = 'none';
        resultScreen.style.display = 'none';
        return;
      }

      initializeGame();
      resultScreen.style.display = 'none';
      canvas.style.display = 'block';
      info.style.display = 'block';
      info.textContent = `ì í”„ íšŸìˆ˜: ${jumpCount} / 30`;
      requestAnimationFrame(update);
    }
  </script>
</body>
</html>
